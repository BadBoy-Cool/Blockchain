<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>ğŸ  Dashboard Má»Ÿ Rá»™ng</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .dashboard { max-width: 800px; margin: auto; }
        .button { padding: 10px 20px; margin: 5px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        .button:hover { background-color: #45a049; }
        .transaction { border: 1px solid #ddd; padding: 10px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="dashboard">
        <h1>ğŸ  Dashboard Má»Ÿ Rá»™ng</h1>
        <p>Thá»i gian hiá»‡n táº¡i: {{ current_time }}</p>
        <h2>Chá»©c nÄƒng má»›i</h2>
        <form action="/international_payroll" method="POST">
            <label>Thanh toÃ¡n USDC</label><br>
            <input type="number" name="employee_id" placeholder="ID NhÃ¢n viÃªn" required>
            <input type="text" name="month" placeholder="ThÃ¡ng (YYYY-MM)" required>
            <input type="number" name="amount_usdc" step="0.01" placeholder="Sá»‘ tiá»n USDC" required>
            <button type="submit" class="button">Thanh toÃ¡n USDC</button>
        </form>
        <form action="/start_salary_stream" method="POST">
            <label>Stream LÆ°Æ¡ng</label><br>
            <input type="number" name="employee_id" placeholder="ID NhÃ¢n viÃªn" required>
            <input type="text" name="month" placeholder="ThÃ¡ng (YYYY-MM)" required>
            <input type="number" name="amount_per_second" step="0.01" placeholder="USDC/giÃ¢y" required>
            <input type="number" name="duration_seconds" placeholder="Thá»i gian (giÃ¢y)" required>
            <button type="submit" class="button">Khá»Ÿi táº¡o Stream</button>
        </form>
        <form action="/dao_vote" method="POST">
            <label>Äá» xuáº¥t DAO</label><br>
            <input type="number" name="employee_id" placeholder="ID NhÃ¢n viÃªn" required>
            <input type="text" name="proposal_description" placeholder="MÃ´ táº£ Ä‘á» xuáº¥t" required>
            <input type="number" name="fund_amount" step="0.01" placeholder="Sá»‘ tiá»n quá»¹" required>
            <button type="submit" class="button">Táº¡o Äá» xuáº¥t</button>
        </form>
        <form action="/fetch_kpi" method="POST">
            <label>Láº¥y KPI tá»« Oracle</label><br>
            <input type="number" name="employee_id" placeholder="ID NhÃ¢n viÃªn" required>
            <input type="text" name="month" placeholder="ThÃ¡ng (YYYY-MM)" required>
            <button type="submit" class="button">Láº¥y KPI</button>
        </form>
        <form action="/add_contract" method="POST">
            <label>ThÃªm Há»£p Ä‘á»“ng</label><br>
            <input type="number" name="employee_id" placeholder="ID NhÃ¢n viÃªn" required>
            <input type="text" name="contract_data" placeholder="Ná»™i dung há»£p Ä‘á»“ng" required>
            <input type="text" name="start_date" placeholder="NgÃ y báº¯t Ä‘áº§u (YYYY-MM-DD)" required>
            <button type="submit" class="button">ThÃªm Há»£p Ä‘á»“ng</button>
        </form>
        <h2>Lá»‹ch sá»­ Giao Dá»‹ch</h2>
        {% if transactions %}
            {% for tx_list in transactions %}
                {% for tx in tx_list %}
                <div class="transaction">
                    <p>ğŸ‘¤ NhÃ¢n viÃªn #{{ tx.employee_id }}</p>
                    {% if tx.amount_usdc %}
                    <p>ğŸ’µ USDC: {{ tx.amount_usdc }}</p>
                    {% elif tx.amount_per_second %}
                    <p>ğŸ’¸ Stream: {{ tx.amount_per_second }} USDC/giÃ¢y, {{ tx.duration_seconds }} giÃ¢y</p>
                    {% elif tx.proposal_description %}
                    <p>ğŸ“œ DAO: {{ tx.proposal_description }} (Quá»¹: ${{ "%.2f"|format(tx.fund_amount) }})</p>
                    {% elif tx.kpi_score %}
                    <p>ğŸ¯ KPI: {{ "%.1f"|format(tx.kpi_score) }}</p>
                    {% elif tx.contract_data %}
                    <p>ğŸ“œ Há»£p Ä‘á»“ng: {{ tx.contract_data }} (Báº¯t Ä‘áº§u: {{ tx.start_date }})</p>
                    {% else %}
                    <p>ğŸ’µ LÆ°Æ¡ng: ${{ "%.2f"|format(tx.total_salary) }}</p>
                    {% endif %}
                    {% if tx.tx_hash %}
                    <p>ğŸ”— Tx Hash: {{ tx.tx_hash }}</p>
                    {% endif %}
                </div>
                {% endfor %}
            {% endfor %}
        {% else %}
            <p>ğŸ“­ ChÆ°a cÃ³ giao dá»‹ch nÃ o</p>
        {% endif %}
        <a href="/dashboard">ğŸ  Vá» Dashboard CÅ©</a>
    </div>
    <script>
        document.getElementById('current_time').innerText = new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' });
    </script>
</body>
</html>